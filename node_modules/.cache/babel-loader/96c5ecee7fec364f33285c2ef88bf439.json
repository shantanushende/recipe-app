{"ast":null,"code":"import _regeneratorRuntime from\"/Users/shantanushende/Desktop/r-app-git/recipe-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shantanushende/Desktop/r-app-git/recipe-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/shantanushende/Desktop/r-app-git/recipe-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import{auth}from\"../firebase\";import firebase from'firebase/app';import'firebase/firestore';import'firebase/auth';import'firebase/analytics';import{useAuthState}from'react-firebase-hooks/auth';import{useCollectionData}from'react-firebase-hooks/firestore';import'./App.css';var firestore=firebase.firestore();function ChatRoom(){var dummy=useRef();var messagesRef=firestore.collection('messages');var query=messagesRef.orderBy('createdAt').limit(25);var _useCollectionData=useCollectionData(query,{idField:'id'}),_useCollectionData2=_slicedToArray(_useCollectionData,1),messages=_useCollectionData2[0];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),formValue=_useState2[0],setFormValue=_useState2[1];var sendMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _auth$currentUser,uid,photoURL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_auth$currentUser=auth.currentUser,uid=_auth$currentUser.uid,photoURL=_auth$currentUser.photoURL;_context.next=4;return messagesRef.add({text:formValue,createdAt:firebase.firestore.FieldValue.serverTimestamp(),uid:uid,photoURL:photoURL});case 4:setFormValue('');dummy.current.scrollIntoView({behavior:'smooth'});case 6:case\"end\":return _context.stop();}}},_callee);}));return function sendMessage(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"main\",null,messages&&messages.map(function(msg){return/*#__PURE__*/React.createElement(ChatMessage,{key:msg.id,message:msg});}),/*#__PURE__*/React.createElement(\"span\",{ref:dummy})),/*#__PURE__*/React.createElement(\"form\",{onSubmit:sendMessage},/*#__PURE__*/React.createElement(\"input\",{value:formValue,onChange:function onChange(e){return setFormValue(e.target.value);},placeholder:\"say something nice\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",disabled:!formValue},\"\\uD83D\\uDD4A\\uFE0F\")));}function ChatMessage(props){var _props$message=props.message,text=_props$message.text,uid=_props$message.uid,photoURL=_props$message.photoURL;var messageClass=uid===auth.currentUser.uid?'sent':'received';return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"message \".concat(messageClass)},/*#__PURE__*/React.createElement(\"img\",{src:photoURL||'https://api.adorable.io/avatars/23/abott@adorable.png'}),/*#__PURE__*/React.createElement(\"p\",null,text)));}export default ChatRoom;","map":{"version":3,"sources":["/Users/shantanushende/Desktop/r-app-git/recipe-app/src/Chatroom/ChatRoom.js"],"names":["React","useRef","useState","Link","useHistory","auth","firebase","useAuthState","useCollectionData","firestore","ChatRoom","dummy","messagesRef","collection","query","orderBy","limit","idField","messages","formValue","setFormValue","sendMessage","e","preventDefault","currentUser","uid","photoURL","add","text","createdAt","FieldValue","serverTimestamp","current","scrollIntoView","behavior","map","msg","id","target","value","ChatMessage","props","message","messageClass"],"mappings":"wfAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,QAAxB,KAAwC,OAAxC,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,IAAT,KAAqB,aAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,cAArB,CACA,MAAO,oBAAP,CACA,MAAO,eAAP,CACA,MAAO,oBAAP,CACA,OAASC,YAAT,KAA6B,2BAA7B,CACA,OAASC,iBAAT,KAAkC,gCAAlC,CACA,MAAO,WAAP,CAEA,GAAMC,CAAAA,SAAS,CAAGH,QAAQ,CAACG,SAAT,EAAlB,CACA,QAASC,CAAAA,QAAT,EAAoB,CAClB,GAAMC,CAAAA,KAAK,CAAGV,MAAM,EAApB,CACA,GAAMW,CAAAA,WAAW,CAAGH,SAAS,CAACI,UAAV,CAAqB,UAArB,CAApB,CACA,GAAMC,CAAAA,KAAK,CAAGF,WAAW,CAACG,OAAZ,CAAoB,WAApB,EAAiCC,KAAjC,CAAuC,EAAvC,CAAd,CAHkB,uBAKCR,iBAAiB,CAACM,KAAD,CAAQ,CAAEG,OAAO,CAAE,IAAX,CAAR,CALlB,0DAKXC,QALW,sCAOgBhB,QAAQ,CAAC,EAAD,CAPxB,wCAOXiB,SAPW,eAOAC,YAPA,eAUlB,GAAMC,CAAAA,WAAW,0FAAG,iBAAOC,CAAP,qJAClBA,CAAC,CAACC,cAAF,GADkB,kBAGQlB,IAAI,CAACmB,WAHb,CAGVC,GAHU,mBAGVA,GAHU,CAGLC,QAHK,mBAGLA,QAHK,uBAKZd,CAAAA,WAAW,CAACe,GAAZ,CAAgB,CACpBC,IAAI,CAAET,SADc,CAEpBU,SAAS,CAAEvB,QAAQ,CAACG,SAAT,CAAmBqB,UAAnB,CAA8BC,eAA9B,EAFS,CAGpBN,GAAG,CAAHA,GAHoB,CAIpBC,QAAQ,CAARA,QAJoB,CAAhB,CALY,QAYlBN,YAAY,CAAC,EAAD,CAAZ,CACAT,KAAK,CAACqB,OAAN,CAAcC,cAAd,CAA6B,CAAEC,QAAQ,CAAE,QAAZ,CAA7B,EAbkB,sDAAH,kBAAXb,CAAAA,WAAW,4CAAjB,CAgBA,mBAAQ,qDACN,gCAEGH,QAAQ,EAAIA,QAAQ,CAACiB,GAAT,CAAa,SAAAC,GAAG,qBAAI,oBAAC,WAAD,EAAa,GAAG,CAAEA,GAAG,CAACC,EAAtB,CAA0B,OAAO,CAAED,GAAnC,EAAJ,EAAhB,CAFf,cAIE,4BAAM,GAAG,CAAEzB,KAAX,EAJF,CADM,cASN,4BAAM,QAAQ,CAAEU,WAAhB,eAEE,6BAAO,KAAK,CAAEF,SAAd,CAAyB,QAAQ,CAAE,kBAACG,CAAD,QAAOF,CAAAA,YAAY,CAACE,CAAC,CAACgB,MAAF,CAASC,KAAV,CAAnB,EAAnC,CAAwE,WAAW,CAAC,oBAApF,EAFF,cAIE,8BAAQ,IAAI,CAAC,QAAb,CAAsB,QAAQ,CAAE,CAACpB,SAAjC,uBAJF,CATM,CAAR,CAiBD,CAGD,QAASqB,CAAAA,WAAT,CAAqBC,KAArB,CAA4B,oBACMA,KAAK,CAACC,OADZ,CAClBd,IADkB,gBAClBA,IADkB,CACZH,GADY,gBACZA,GADY,CACPC,QADO,gBACPA,QADO,CAG1B,GAAMiB,CAAAA,YAAY,CAAGlB,GAAG,GAAKpB,IAAI,CAACmB,WAAL,CAAiBC,GAAzB,CAA+B,MAA/B,CAAwC,UAA7D,CAEA,mBAAQ,qDACN,2BAAK,SAAS,mBAAakB,YAAb,CAAd,eACE,2BAAK,GAAG,CAAEjB,QAAQ,EAAI,uDAAtB,EADF,cAEE,6BAAIE,IAAJ,CAFF,CADM,CAAR,CAMD,CAED,cAAelB,CAAAA,QAAf","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { auth } from \"../firebase\";\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport 'firebase/auth';\nimport 'firebase/analytics';\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\nimport './App.css';\n\nconst firestore = firebase.firestore();\nfunction ChatRoom() {\n  const dummy = useRef();\n  const messagesRef = firestore.collection('messages');\n  const query = messagesRef.orderBy('createdAt').limit(25);\n\n  const [messages] = useCollectionData(query, { idField: 'id' });\n\n  const [formValue, setFormValue] = useState('');\n\n\n  const sendMessage = async (e) => {\n    e.preventDefault();\n\n    const { uid, photoURL } = auth.currentUser;\n\n    await messagesRef.add({\n      text: formValue,\n      createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n      uid,\n      photoURL\n    })\n\n    setFormValue('');\n    dummy.current.scrollIntoView({ behavior: 'smooth' });\n  }\n\n  return (<>\n    <main>\n\n      {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\n\n      <span ref={dummy}></span>\n\n    </main>\n\n    <form onSubmit={sendMessage}>\n\n      <input value={formValue} onChange={(e) => setFormValue(e.target.value)} placeholder=\"say something nice\" />\n\n      <button type=\"submit\" disabled={!formValue}>üïäÔ∏è</button>\n\n    </form>\n  </>)\n}\n\n\nfunction ChatMessage(props) {\n  const { text, uid, photoURL } = props.message;\n\n  const messageClass = uid === auth.currentUser.uid ? 'sent' : 'received';\n\n  return (<>\n    <div className={`message ${messageClass}`}>\n      <img src={photoURL || 'https://api.adorable.io/avatars/23/abott@adorable.png'} />\n      <p>{text}</p>\n    </div>\n  </>)\n}\n\nexport default ChatRoom;"]},"metadata":{},"sourceType":"module"}